<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Zen X 7777 Agent</title><script src="https://cdn.tailwindcss.com"></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"><style>body{font-family:'Inter',sans-serif;background-color:#f4f6f8}@keyframes soft-float{0%,100%{transform:translateY(0)}50%{transform:translateY(-2px)}}.card-aesthetic{background-color:#fff;box-shadow:0 3px 10px rgba(0,0,0,.08);transition:transform .3s,box-shadow .3s;border-radius:1.5rem;animation:soft-float 3s ease-in-out infinite}.card-aesthetic:hover{box-shadow:0 8px 20px rgba(0,0,0,.15);transform:scale(1.02) translateY(-3px);animation-play-state:paused}@keyframes blink-green{0%,100%{background-color:#10B981}50%{background-color:#D1FAE5}}@keyframes blink-red{0%,100%{background-color:#EF4444}50%{background-color:#FEE2E2}}@keyframes gold-shine{0%,100%{box-shadow:0 0 0 1px #FFD700,0 0 15px #FFD700}50%{box-shadow:0 0 0 3px rgba(255,215,0,.8),0 0 25px rgba(255,215,0,.5)}}.light-green{animation:blink-green 1.5s infinite}.light-red{animation:blink-red 1.5s infinite}.fire-active{position:relative;overflow:hidden}.fire-active::before{content:'';position:absolute;top:-2px;left:-2px;right:-2px;bottom:-2px;border-radius:inherit;border:2px solid transparent;background:linear-gradient(45deg,#FFD700,#FFA500,rgba(255,215,0,0)) border-box;mask:linear-gradient(#fff 0 0) padding-box,linear-gradient(#fff 0 0);mask-composite:exclude;animation:gold-shine 2s ease-in-out infinite}.data-row{display:grid;grid-template-columns:1fr auto;align-items:center;border-radius:1rem}#admin-modal-content{max-width:320px}.shadow-blue-glow{box-shadow:0 0 10px rgba(59,130,246,.6)}.top-referer-card{background-color:#1f2937!important;border:2px solid #FFD700;box-shadow:0 6px 20px rgba(255,215,0,.5)}.modal-content{transition:all .3s ease-out;transform:translateY(0);opacity:1}.modal-close{transform:translateY(-10px);opacity:0}.toggle-switch-bg{transition:all .3s ease-in-out}.toggle-switch-circle{transition:all .3s ease-in-out}</style></head><body class="min-h-screen"><div class="container mx-auto p-4 sm:px-6 lg:px-8 max-w-xl"><header class="text-center py-6 bg-white card-aesthetic rounded-3xl mb-6"><h1 class="text-3xl font-extrabold text-gray-800">Zen X 7777 Agent</h1><p class="text-sm text-gray-500 mt-1">Program refferal By Zen</p></header><div class="flex flex-col sm:flex-row justify-center gap-3 mb-4"><a href="javascript:void(0)" onclick="showTermsModal()" class="shadow-blue-glow flex items-center justify-center px-4 py-2 text-sm font-medium rounded-xl text-white bg-blue-600 hover:bg-blue-700 transition duration-150">Syarat & Ketentuan</a><button onclick="showJoinFormModal()" class="shadow-blue-glow flex items-center justify-center px-4 py-2 text-sm font-medium rounded-xl text-white bg-blue-600 hover:bg-blue-700 transition duration-150">Gabung Menjadi Pengundang</button></div><div class="flex justify-center mb-8 border-b pb-4"><button onclick="showAdminPanel()" class="flex items-center justify-center px-4 py-2 text-xs font-semibold rounded-xl text-gray-600 bg-gray-200 hover:bg-gray-300 transition duration-150 border border-gray-300 shadow-sm"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H5a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"/></svg>Tambah Data</button></div><section class="mb-10"><h2 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2">Kode Referal Agen</h2><div id="loading-indicator" class="text-center py-6 text-gray-500 hidden"><div class="animate-spin inline-block w-6 h-6 border-3 border-blue-500 border-t-transparent rounded-full"></div><p class="mt-2 text-sm">Memuat data...</p></div><div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl relative mb-4" role="alert"><strong class="font-bold">Gagal memuat data!</strong><span id="error-details" class="block sm:inline text-sm"></span></div><div id="data-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div><div id="custom-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50 p-4" onclick="closeModal()"><div class="bg-white p-5 rounded-2xl shadow-2xl max-w-sm w-full modal-content modal-close" id="custom-modal-content" onclick="event.stopPropagation()"><h3 class="text-lg font-bold mb-3" id="modal-title">Notifikasi</h3><div class="text-gray-600 mb-4 text-sm max-h-80 overflow-y-auto" id="modal-body"></div><button onclick="closeModal()" class="w-full bg-blue-600 text-white py-2 rounded-xl hover:bg-blue-700 text-sm">Tutup</button></div></div></section></div><div id="admin-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50 p-4"><div class="bg-white p-5 rounded-2xl shadow-2xl w-full transform transition-all duration-300 relative" id="admin-modal-content"><div id="admin-panel-view" class="max-w-xs mx-auto max-h-[85vh] overflow-y-auto pr-1"><h3 class="text-xl font-bold text-gray-800 mb-3">Panel Kontrol Agen</h3><div class="mb-4 p-4 rounded-2xl bg-gray-50 flex items-center justify-between border shadow-sm"><p class="font-semibold text-sm text-gray-700">Status Tombol Withdraw:</p><div class="flex items-center space-x-2"><span id="withdraw-status-text" class="text-xs font-bold text-green-600">AKTIF</span><button id="withdraw-toggle" onclick="promptAdminPassword('toggle')" class="relative inline-flex items-center h-6 rounded-full w-11 toggle-switch-bg bg-green-500"><span id="withdraw-toggle-circle" class="inline-block w-4 h-4 transform bg-white rounded-full toggle-switch-circle translate-x-6"></span></button></div></div><div class="mb-4 border p-4 rounded-2xl bg-gray-50 shadow-sm"><h4 class="text-base font-semibold mb-3" id="form-title">Tambah Data Baru</h4><input type="hidden" id="data-id-field"><div class="mb-2"><label for="email-field" class="block text-xs font-medium text-gray-700">Email Agen</label><input type="email" id="email-field" placeholder="contoh@agent.com" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"></div><div class="mb-2"><label for="referral-field" class="block text-xs font-medium text-gray-700">Kode Referal</label><input type="text" id="referral-field" placeholder="Kode Referal" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"></div><div class="mb-3"><label for="status-field" class="block text-xs font-medium text-gray-700">Status</label><select id="status-field" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"><option value="Normal">Normal</option><option value="Restrict">Restrict</option></select></div><button onclick="handleSaveClick()" id="save-button" class="w-full bg-green-600 text-white py-2 rounded-xl text-sm font-semibold hover:bg-green-700 transition duration-150">Simpan Data</button><button onclick="resetForm()" id="cancel-button" class="w-full mt-2 text-gray-600 py-1.5 text-sm hover:bg-gray-100 rounded-xl transition duration-150 hidden">Batal Edit</button></div><h4 class="text-base font-semibold text-gray-700 mb-2">Manajemen Data</h4><div id="admin-data-list" class="space-y-2 max-h-48 overflow-y-auto pr-1"></div><button onclick="promptAdminPassword('deleteAll')" class="mt-4 w-full bg-red-500 text-white py-2 text-sm rounded-xl font-semibold hover:bg-red-600">Hapus Semua Data (Reset)</button><button onclick="hideAdminModal()" class="mt-2 w-full text-gray-600 py-1.5 text-sm hover:bg-gray-100 rounded-xl border">Tutup Panel</button></div></div></div><div id="auth-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50 p-4"><div class="bg-white p-5 rounded-2xl shadow-2xl max-w-xs w-full"><h3 class="text-lg font-bold mb-3 text-red-600">Autentikasi Admin</h3><p class="text-gray-600 mb-4 text-sm">Masukkan kode admin untuk melanjutkan aksi:</p><input type="password" id="auth-password-input" placeholder="Kode Rahasia" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"><input type="hidden" id="auth-action-type"><input type="hidden" id="auth-target-id"><div class="flex justify-end gap-2 mt-4"><button onclick="closeAuthModal()" class="px-3 py-1.5 bg-gray-200 text-gray-800 text-sm rounded-xl hover:bg-gray-300">Batal</button><button onclick="checkAdminPasswordAndExecute()" class="px-3 py-1.5 bg-blue-600 text-white text-sm rounded-xl hover:bg-blue-700 font-semibold">Konfirmasi</button></div></div></div><div id="delete-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50"><div class="bg-white p-5 rounded-2xl shadow-2xl max-w-xs w-full"><h3 class="text-lg font-bold mb-3 text-red-600">Konfirmasi Penghapusan</h3><p class="text-gray-600 mb-4 text-sm">Apakah Anda yakin ingin menghapus data ini? Aksi ini tidak dapat dibatalkan.</p><div class="flex justify-end gap-2"><button onclick="closeDeleteModal()" class="px-3 py-1.5 bg-gray-200 text-gray-800 text-sm rounded-xl hover:bg-gray-300">Batal</button><button onclick="confirmDeleteData()" class="px-3 py-1.5 bg-red-600 text-white text-sm rounded-xl hover:bg-red-700 font-semibold">Hapus Permanen</button></div></div></div><div id="delete-all-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50"><div class="bg-white p-5 rounded-2xl shadow-2xl max-w-xs w-full"><h3 class="text-lg font-bold mb-3 text-red-600">PERINGATAN! Hapus Semua Data</h3><p class="text-gray-600 mb-4 text-sm font-semibold">Anda akan menghapus SEMUA data agen di bin ID ini. Tindakan ini TIDAK dapat dibatalkan.</p><p class="text-gray-500 mb-4 text-xs">Pastikan Anda benar-benar yakin sebelum melanjutkan.</p><div class="flex justify-end gap-2"><button onclick="closeDeleteAllModal()" class="px-3 py-1.5 bg-gray-200 text-gray-800 text-sm rounded-xl hover:bg-gray-300">Batal</button><button onclick="confirmDeleteAllData()" class="px-3 py-1.5 bg-red-600 text-white text-sm rounded-xl hover:bg-red-700 font-semibold">YA, HAPUS SEMUA</button></div></div></div><script>const BIN_ID='68c9791f43b1c97be945093d';const API_KEY='$2a$10$CyEgkHrw6xtwHt.RE3ZqEulgvcK5yzSmlYJmn.aRA23csA9a8u/.2';const ADMIN_CODE='15082003';const API_URL=`https://api.jsonbin.io/v3/b/${BIN_ID}`;const PHONE_NUMBER='62859106914815';let currentData=[];let dataToDeleteId=null;let isWithdrawEnabled=true;function showAdminPanel(){document.getElementById('admin-modal').classList.remove('hidden');document.getElementById('admin-modal').classList.add('flex');renderAdminList();updateWithdrawToggleState()}function hideAdminModal(){document.getElementById('admin-modal').classList.add('hidden');document.getElementById('admin-modal').classList.remove('flex');resetForm()}function showModal(title,body,isHtml=false){const modal=document.getElementById('custom-modal');const content=document.getElementById('custom-modal-content');document.getElementById('modal-title').textContent=title;if(isHtml){document.getElementById('modal-body').innerHTML=body}else{document.getElementById('modal-body').textContent=body}modal.classList.remove('hidden');modal.classList.add('flex');setTimeout(()=>{content.classList.remove('modal-close');content.classList.add('modal-content')},10)}function closeModal(){const modal=document.getElementById('custom-modal');const content=document.getElementById('custom-modal-content');content.classList.add('modal-close');content.classList.remove('modal-content');setTimeout(()=>{modal.classList.add('hidden');modal.classList.remove('flex')},300)}function promptAdminPassword(action,targetId=null){document.getElementById('auth-action-type').value=action;document.getElementById('auth-target-id').value=targetId||'';document.getElementById('auth-password-input').value='';document.getElementById('auth-modal').classList.remove('hidden');document.getElementById('auth-modal').classList.add('flex')}function closeAuthModal(){document.getElementById('auth-modal').classList.add('hidden');document.getElementById('auth-modal').classList.remove('flex')}function checkAdminPasswordAndExecute(){const password=document.getElementById('auth-password-input').value;const action=document.getElementById('auth-action-type').value;const targetId=document.getElementById('auth-target-id').value;if(password===ADMIN_CODE){closeAuthModal();executeAdminAction(action,targetId)}else{document.getElementById('auth-password-input').value='';showModal('Akses Ditolak','Kode admin salah. Aksi dibatalkan.')}}function executeAdminAction(action,targetId){if(action==='edit'){editData(targetId)}else if(action==='delete'){deleteData(targetId)}else if(action==='toggle'){toggleWithdrawStatus(true)}else if(action==='deleteAll'){deleteAllDataConfirmation()}else if(action==='save'){performSave()}}function handleSaveClick(){const idField=document.getElementById('data-id-field');const existingId=idField.value;const email=document.getElementById('email-field').value.trim();const referralCode=document.getElementById('referral-field').value.trim();if(!email||!referralCode){showModal('Input Kosong','Email dan Kode Referal tidak boleh kosong.');return}if(existingId){promptAdminPassword('save',existingId)}else{performSave()}}function generateUniqueId(){return Date.now().toString(36)+Math.random().toString(36).substring(2,5)}function showLoading(isVisible){document.getElementById('loading-indicator').classList.toggle('hidden',!isVisible);document.getElementById('error-message').classList.add('hidden')}function showError(message){document.getElementById('error-details').textContent=message;document.getElementById('error-message').classList.remove('hidden')}function updateWithdrawToggleState(){const toggle=document.getElementById('withdraw-toggle');const circle=document.getElementById('withdraw-toggle-circle');const text=document.getElementById('withdraw-status-text');if(isWithdrawEnabled){toggle.classList.remove('bg-gray-400');toggle.classList.add('bg-green-500');circle.classList.remove('translate-x-0');circle.classList.add('translate-x-6');text.textContent='AKTIF';text.classList.remove('text-red-600');text.classList.add('text-green-600')}else{toggle.classList.remove('bg-green-500');toggle.classList.add('bg-gray-400');circle.classList.remove('translate-x-6');circle.classList.add('translate-x-0');text.textContent='TUTUP';text.classList.remove('text-green-600');text.classList.add('text-red-600')}}async function toggleWithdrawStatus(confirmed=false){if(!confirmed)return promptAdminPassword('toggle');const newStatus=!isWithdrawEnabled;await updateWithdrawControl(newStatus)}async function updateWithdrawControl(newStatus){showLoading(true);try{const response=await fetch(API_URL,{method:'PUT',headers:{'Content-Type':'application/json','X-Master-Key':API_KEY,'X-Bin-Versioning':false},body:JSON.stringify({users:currentData.map(item=>{const{id,...rest}=item;return rest}),isWithdrawEnabled:newStatus})});if(!response.ok){const errorJson=await response.json();throw new Error(`Gagal update kontrol: ${errorJson.message||'Unknown error'}`)}isWithdrawEnabled=newStatus;updateWithdrawToggleState();showModal('Sukses!','Status tombol Withdraw berhasil diubah.')}catch(error){console.error("Update Control Error:",error);showError(`Admin Error (Control): ${error.message}`)}finally{showLoading(false)}}async function fetchData(){showLoading(true);try{const response=await fetch(API_URL,{method:'GET',headers:{'Content-Type':'application/json','X-Master-Key':API_KEY}});if(!response.ok){throw new Error(`Gagal mengambil data: ${response.status} ${response.statusText}`)}const json=await response.json();let usersFromBin=Array.isArray(json.record.users)?json.record.users:[];currentData=usersFromBin.map(item=>{if(!item.id){item.id=generateUniqueId()}return item});isWithdrawEnabled=json.record.isWithdrawEnabled!==false;renderData();renderAdminList();updateWithdrawToggleState()}catch(error){console.error("Fetch Data Error:",error);showError(error.message)}finally{showLoading(false)}}async function updateBinData(newData){showLoading(true);try{const payload={users:newData.map(item=>{const{id,...rest}=item;return rest}),isWithdrawEnabled:isWithdrawEnabled};const response=await fetch(API_URL,{method:'PUT',headers:{'Content-Type':'application/json','X-Master-Key':API_KEY,'X-Bin-Versioning':false},body:JSON.stringify(payload)});if(!response.ok){const errorJson=await response.json();throw new Error(`Gagal menyimpan data: ${response.status} ${response.statusText}. Pesan: ${errorJson.message||'Unknown error'}`)}await response.json();await fetchData();showModal('Sukses!','Data berhasil disimpan dan diperbarui.')}catch(error){console.error("Update Data Error:",error);showError(`Admin Error: ${error.message}`)}finally{showLoading(false)}}async function performSave(){const idField=document.getElementById('data-id-field');const email=document.getElementById('email-field').value.trim();const referralCode=document.getElementById('referral-field').value.trim();const status=document.getElementById('status-field').value;const existingId=idField.value;if(!email||!referralCode){showModal('Input Kosong','Email dan Kode Referal tidak boleh kosong.');return}let updatedData;const newItemOrUpdate={email,referral_code:referralCode,status};if(existingId){updatedData=currentData.map(item=>{if(String(item.id)===existingId){return{id:item.id,...newItemOrUpdate}}return item})}else{const newId=generateUniqueId();const newItem={id:newId,...newItemOrUpdate};updatedData=[...currentData,newItem]}await updateBinData(updatedData);resetForm()}function deleteData(id){dataToDeleteId=id;document.getElementById('delete-modal').classList.remove('hidden');document.getElementById('delete-modal').classList.add('flex')}async function confirmDeleteData(){if(dataToDeleteId===null)return;const idToDelete=dataToDeleteId;dataToDeleteId=null;closeDeleteModal();const updatedData=currentData.filter(item=>String(item.id)!==String(idToDelete));await updateBinData(updatedData)}function closeDeleteModal(){document.getElementById('delete-modal').classList.add('hidden');document.getElementById('delete-modal').classList.remove('flex');dataToDeleteId=null}function deleteAllDataConfirmation(){document.getElementById('delete-all-modal').classList.remove('hidden');document.getElementById('delete-all-modal').classList.add('flex')}function closeDeleteAllModal(){document.getElementById('delete-all-modal').classList.add('hidden');document.getElementById('delete-all-modal').classList.remove('flex')}async function confirmDeleteAllData(){closeDeleteAllModal();await updateBinData([])}function editData(id){const itemToEdit=currentData.find(item=>String(item.id)===String(id));if(!itemToEdit)return;document.getElementById('form-title').textContent='Edit Data Agen (ID: '+itemToEdit.id+')';document.getElementById('data-id-field').value=itemToEdit.id;document.getElementById('email-field').value=itemToEdit.email;document.getElementById('referral-field').value=itemToEdit.referral_code;document.getElementById('status-field').value=itemToEdit.status;document.getElementById('save-button').textContent='Perbarui Data';document.getElementById('cancel-button').classList.remove('hidden')}function resetForm(){document.getElementById('form-title').textContent='Tambah Data Baru';document.getElementById('data-id-field').value='';document.getElementById('email-field').value='';document.getElementById('referral-field').value='';document.getElementById('status-field').value='Normal';document.getElementById('save-button').textContent='Simpan Data';document.getElementById('cancel-button').classList.add('hidden')}function renderAdminList(){const container=document.getElementById('admin-data-list');container.innerHTML='';if(currentData.length===0){container.innerHTML='<p class="text-center text-gray-500 text-sm">Belum ada data. Silakan tambahkan data baru.</p>';return}currentData.forEach(item=>{const statusColor=item.status==='Restrict'?'text-red-600':'text-green-600';const listItem=`<div class="flex items-center justify-between p-3 bg-white border border-gray-200 rounded-xl shadow-sm"><div class="min-w-0 flex-1 mr-3"><p class="font-semibold text-gray-800 truncate">${item.email}</p><span class="text-xs text-gray-500">Ref: ${item.referral_code||'-'}</span><span class="text-xs ${statusColor} ml-2 font-medium">Status: ${item.status}</span></div><div class="flex gap-1.5 flex-shrink-0"><button onclick="promptAdminPassword('edit','${item.id}')" class="text-xs text-blue-500 hover:text-blue-700 p-1 rounded-lg transition duration-150 font-semibold">Edit</button><button onclick="promptAdminPassword('delete','${item.id}')" class="text-xs text-red-500 hover:text-red-700 p-1 rounded-lg transition duration-150 font-semibold">Hapus</button></div></div>`;container.innerHTML+=listItem})}function renderData(){const container=document.getElementById('data-container');container.innerHTML='';if(currentData.length===0){container.innerHTML='<p class="text-center text-gray-500 col-span-full text-sm py-4">Belum ada Kode Referal yang tersedia.</p>';return}const referralStats=currentData.reduce((acc,item)=>{const refCode=item.referral_code;if(refCode&&refCode!=='TIDAK ADA'){acc[refCode]=(acc[refCode]||0)+1}return acc},{});const uniqueRefCodes=Object.keys(referralStats);if(uniqueRefCodes.length===0){container.innerHTML='<p class="text-center text-gray-500 col-span-full text-sm py-4">Tidak ada Kode Referal yang unik (selain \'TIDAK ADA\').</p>';return}uniqueRefCodes.forEach(refCode=>{const totalEmails=referralStats[refCode];const isTopReferer=totalEmails>=10;let cardClasses='card-aesthetic p-5 flex flex-col justify-between transition duration-300';let refCodeClasses='font-extrabold text-3xl text-blue-800 bg-blue-100 py-1.5 px-3 rounded-xl inline-block';let textColor='text-gray-700';let totalColor='text-green-600';const dataRow=document.createElement('div');if(isTopReferer){cardClasses='card-aesthetic p-6 flex flex-col justify-between top-referer-card transition duration-300';refCodeClasses='font-extrabold text-4xl text-yellow-300 bg-gray-900 py-1.5 px-3 rounded-xl inline-block';textColor='text-gray-200';totalColor='text-yellow-400'}dataRow.className=cardClasses;const refCodeContent=`<div class="flex flex-col mb-4"><span class="text-xs font-medium ${textColor} mb-1">${isTopReferer ? 'âœ¨ TOP REFERER CODE' : 'Kode Referal:'}</span><div class="${refCodeClasses}">${refCode}</div></div><div class="flex justify-between items-center"><p class="text-sm ${textColor} font-semibold">Total Undang: <span class="font-bold text-xl ${totalColor}">${totalEmails}</span></p><button onclick="showReferralDetails('${refCode}')" class="p-3 rounded-full ${isTopReferer ? 'bg-yellow-400 text-gray-900 hover:bg-yellow-500' : 'bg-blue-600 text-white hover:bg-blue-700'} transition duration-150 shadow-md" title="Lihat Detail Referal"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/></svg></button></div>`;dataRow.innerHTML=refCodeContent;container.appendChild(dataRow)})}function animateCounter(element,finalValue,duration){let startTimestamp=null;const step=timestamp=>{if(!startTimestamp)startTimestamp=timestamp;const progress=Math.min((timestamp-startTimestamp)/duration,1);const current=(Math.random()*(finalValue+50)).toFixed(2);element.textContent=`$${progress===1?finalValue.toFixed(2):current}`;if(progress<1){window.requestAnimationFrame(step)}};window.requestAnimationFrame(step)}function showReferralDetails(refCode){const referrals=currentData.filter(item=>item.referral_code===refCode);let totalEarnings=0;let detailListHtml='';if(referrals.length===0){showModal("Detail Referal",`Tidak ada data referal yang ditemukan untuk kode: ${refCode}.`);return}referrals.forEach(ref=>{let earnings=0;let lightClass='';let fireClass='';if(ref.status==='Normal'){earnings=2;totalEarnings+=earnings;lightClass='light-green bg-green-500';fireClass='fire-active'}else if(ref.status==='Restrict'){earnings=1;totalEarnings+=earnings;lightClass='light-red bg-red-500'}detailListHtml+=`<li class="flex items-center justify-between p-2 rounded-xl text-sm transition duration-100 bg-white shadow-sm border border-gray-100 mb-1.5 ${fireClass}"><div class="flex items-center"><span class="inline-block w-2.5 h-2.5 rounded-full mr-2 flex-shrink-0 ${lightClass}"></span><span class="text-gray-700 font-medium truncate">${ref.email}</span></div><span class="text-xs font-semibold text-gray-500 flex-shrink-0">(${ref.status} - $${earnings})</span></li>`});let withdrawButton;if(isWithdrawEnabled){withdrawButton=`<button onclick="showWithdrawForm('${refCode}', ${totalEarnings})" class="w-full mt-4 bg-yellow-500 text-gray-900 py-2 rounded-xl hover:bg-yellow-600 text-sm font-semibold transition duration-150">Ajukan Withdraw</button>`}else{withdrawButton=`<div class="w-full mt-4 p-2 text-center bg-gray-100 text-red-600 rounded-xl text-sm font-semibold border-2 border-red-300">Pencairan sedang di tutup</div>`}const bodyContent=`<div class="space-y-4"><div class="text-center pb-3 border-b border-gray-200 mb-4"><h4 class="text-xl font-bold text-gray-800">Detail Kode <span class="text-blue-600">${refCode}</span></h4><p class="text-xs text-gray-500">Analisis Perolehan Referal</p></div><div class="p-4 bg-green-100 rounded-xl border border-green-300 text-center shadow-lg"><p class="text-sm font-medium text-green-800">Total Penghasilan (Estimasi):</p><p id="earnings-counter" class="text-4xl font-extrabold text-green-700 mt-1">$0.00</p></div><h5 class="font-semibold text-gray-700 border-b pb-1 text-sm mt-4">Daftar Agen (${referrals.length} Orang):</h5><ul class="space-y-1 bg-gray-50 p-2 rounded-xl max-h-48 overflow-y-auto">${detailListHtml}</ul><p class="text-xs text-gray-500 pt-2 border-t mt-3 text-center">Indikator: Hijau = Normal ($2) | Merah = Restrict ($1)</p></div>${withdrawButton}`;showModal("Detail Referal",bodyContent,true);const counterElement=document.getElementById('earnings-counter');if(counterElement){animateCounter(counterElement,totalEarnings,1000)}}function showTermsModal(){const termsContent=`<div class="space-y-4 text-gray-700"><h4 class="text-base font-bold text-gray-800 border-b pb-1 flex items-center"><svg class="w-4 h-4 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>Syarat & Kriteria Utama</h4><ul class="space-y-2 text-sm"><li class="flex items-start"><svg class="w-5 h-5 mr-2 text-green-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg><span class="text-gray-700">Orang yang kamu undang harus berhasil menyewakan akunya ke agent bule.</span></li><li class="flex items-start"><svg class="w-5 h-5 mr-2 text-blue-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="text-gray-700">Kamu harus konfirmasi ke admin jika ingin menjadi pengundang.</span></li></ul><h4 class="text-base font-bold text-gray-800 border-b pb-1 mt-4 flex items-center"><svg class="w-4 h-4 mr-2 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"></path></svg>Skema Komisi (Per Invite Normal)</h4><div class="space-y-1.5 text-sm bg-gray-100 p-3 rounded-xl border border-gray-200"><div class="flex justify-between font-bold text-gray-800 p-1 rounded-lg"><span>Jumlah Invite</span><span>Komisi</span></div><div class="flex justify-between border-b border-gray-300 pb-1"><span>1 Invite</span><span class="font-extrabold text-green-600">$2</span></div><div class="flex justify-between border-b border-gray-300 pb-1"><span>2 Invite</span><span class="font-extrabold text-green-600">$4</span></div><div class="flex justify-between"><span>3 Invite</span><span class="font-extrabold text-green-600">$6</span></div><p class="text-xs text-gray-500 pt-2">*) Setiap invite Status <span class="font-bold text-green-600">Normal</span> dihargai $2. Status Restrict $1.</p></div><h4 class="text-base font-bold text-gray-800 border-b pb-1 mt-4 flex items-center"><svg class="w-4 h-4 mr-2 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.597a1 1 0 011.902 0l1.536 4.697a1 1 0 00.95.69h4.943a1 1 0 01.57 1.77l-4.008 2.91a1 1 0 00-.36 1.118l1.536 4.697a1 1 0 01-1.54 1.12L12 18.067l-4.008 2.91a1 1 0 01-1.54-1.12l1.536-4.697a1 1 0 00-.36-1.118l-4.008-2.91a1 1 0 01.57-1.77h4.943a1 1 0 00.95-.69l1.536-4.697z"></path></svg>Bonus Top Referer</h4><div class="bg-red-50 border-l-4 border-red-400 p-3 rounded-xl"><p class="font-semibold text-sm text-red-800">Top Referer akan mendapat bonus <span class="font-bold">Reward Random</span>.</p><p class="text-xs text-gray-600 mt-1">Syarat masuk Top Referer adalah minimal mengundang <span class="font-bold">10 user</span> dengan status Normal.</p></div></div>`;showModal("Syarat & Ketentuan Program",termsContent,true)}function showJoinFormModal(){const formHtml=`<div class="space-y-4"><div class="text-center p-4 rounded-t-2xl bg-blue-500/10 mb-4 -mx-5 -mt-5"><svg class="w-10 h-10 mx-auto text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg><h4 class="text-xl font-extrabold text-gray-800 mt-2">Form Pendaftaran Pengundang</h4><p class="text-xs text-gray-600">Isi data di bawah untuk mengajukan diri sebagai Agen Referal.</p></div><div class="mb-3"><label for="join-name" class="block text-xs font-medium text-gray-700 mb-1">Nama Lengkap</label><input type="text" id="join-name" placeholder="Nama Anda" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"></div><div class="mb-3"><label for="join-phone" class="block text-xs font-medium text-gray-700 mb-1">Nomor HP</label><input type="tel" id="join-phone" placeholder="Contoh: 0812345678" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"></div><div class="mb-4"><label for="join-estimate" class="block text-xs font-medium text-gray-700 mb-1">Berapa Orang yang bisa di undang dalam 1 week?</label><input type="number" id="join-estimate" placeholder="Contoh: 5" min="1" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"></div><button onclick="submitJoinForm()" class="w-full bg-blue-600 text-white py-2 rounded-xl hover:bg-blue-700 text-sm font-semibold shadow-blue-glow transition duration-150">Ajukan Ke Admin via WhatsApp</button><p class="mt-4 text-xs text-gray-500 text-center border-t pt-2">Pengajuan akan dikirim ke Admin untuk ditinjau. Anda akan dialihkan ke WhatsApp.</p></div>`;showModal("Form Untuk Menjadi Pengundang",formHtml,true)}function submitJoinForm(){const name=document.getElementById('join-name').value.trim();const phone=document.getElementById('join-phone').value.trim();const estimate=document.getElementById('join-estimate').value.trim();if(!name||!phone||!estimate){showModal("Input Kurang","Semua kolom wajib diisi untuk mengajukan pendaftaran.");return}const message=`*PENDAFTARAN PENGUNDANG ZEN*\n\n*Nama Lengkap:* ${name}\n*Nomor HP:* ${phone}\n*Estimasi Undang/Minggu:* ${estimate} orang.\n\nMohon diproses untuk menjadi pengundang. Terima kasih.`;const waUrl=`https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(message)}`;closeModal();window.open(waUrl,'_blank')}function setBank(name){document.getElementById('bank-name-field').value=name;const otherBankInput=document.getElementById('other-bank-input');if(name==='Lainnya'){otherBankInput.classList.remove('hidden');document.getElementById('other-bank-name').focus()}else{otherBankInput.classList.add('hidden')}}function showWithdrawForm(refCode,totalEarnings){const bankOptions=[{name:'DANA',color:'bg-blue-600',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2h-1v2H9v-2h-.5c-1.657 0-3-.895-3-2s1.343-2 3-2h1V6h3v2zm-2 0h1m-1 4h1m-1 0h.5c1.105 0 2-.895 2-2s-.895-2-2-2h-1.5z"></path></svg>'},{name:'Seabank',color:'bg-orange-500',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>'},{name:'BRI',color:'bg-blue-900',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"></path></svg>'},{name:'BNI',color:'bg-orange-700',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>'},{name:'Mandiri',color:'bg-blue-800',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14v6m-3-3h6M6 10h2m4 0h2m4 0h2M7 18h.01M17 18h.01M17 14h.01M3 21h18a2 2 0 002-2V5a2 2 0 00-2-2H3a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>'},{name:'Lainnya',color:'bg-gray-400',icon:'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>'}];let bankOptionsHtml='<div class="grid grid-cols-3 gap-2">';bankOptions.forEach(bank=>{bankOptionsHtml+=`<button type="button" onclick="setBank('${bank.name}'); Array.from(document.querySelectorAll('.bank-option')).forEach(btn => btn.classList.remove('border-blue-500')); this.classList.add('border-blue-500');" class="bank-option flex flex-col items-center justify-center p-3 rounded-xl border-2 border-transparent hover:border-blue-500 transition duration-150 ${bank.color} text-white shadow-md"><span class="mb-1">${bank.icon}</span><span class="text-xs font-semibold">${bank.name}</span></button>`});bankOptionsHtml+='</div>';const withdrawFormHtml=`<div class="space-y-4"><div class="text-center pb-3 border-b border-gray-200 mb-4"><h4 class="text-xl font-bold text-gray-800">Formulir Withdraw</h4><p class="text-xs text-gray-500">Ajukan penarikan dana untuk Kode <span class="font-bold text-blue-600">${refCode}</span></p></div><div class="mb-3 p-3 bg-yellow-50 rounded-xl"><p class="text-sm font-semibold text-yellow-800">Estimasi Dana Tersedia: <span class="font-extrabold text-lg">$${totalEarnings.toFixed(2)}</span></p></div><div class="mb-3"><label for="withdraw-name" class="block text-xs font-medium text-gray-700 mb-1">Nama Penerima (Atas Nama)</label><input type="text" id="withdraw-name" placeholder="Nama Lengkap" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"></div><div class="mb-3"><label for="withdraw-phone" class="block text-xs font-medium text-gray-700 mb-1">Nomor Akun/HP (Pencairan)</label><input type="tel" id="withdraw-phone" placeholder="Cth: 08123xxxxxxx / Nomor Akun" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div><div class="mb-4"><label class="block text-xs font-medium text-gray-700 mb-2">Pilih Metode Pencairan</label>${bankOptionsHtml}<input type="hidden" id="bank-name-field" value=""></div><div id="other-bank-input" class="mb-4 hidden"><label for="other-bank-name" class="block text-xs font-medium text-gray-700 mb-1">Nama Bank Custom</label><input type="text" id="other-bank-name" placeholder="Masukkan Nama Bank (cth: BCA)" class="w-full p-2 border border-gray-300 rounded-xl text-sm focus:ring-blue-500 focus:border-blue-500"></div><div class="mb-4"><label for="withdraw-ref-code" class="block text-xs font-medium text-gray-700 mb-1">Kode Referal</label><input type="text" id="withdraw-ref-code" value="${refCode}" class="w-full p-2 border border-gray-300 rounded-xl text-sm bg-gray-100 font-bold" readonly></div><button onclick="submitWithdraw('${refCode}', ${totalEarnings})" class="w-full bg-green-600 text-white py-2 rounded-xl hover:bg-green-700 text-sm font-semibold shadow-md transition duration-150">Ajukan Withdraw ke Admin</button><p class="mt-4 text-xs text-gray-500 text-center border-t pt-2">Pengajuan akan dikirim ke Admin via WhatsApp.</p></div>`;showModal("Pengajuan Withdraw",withdrawFormHtml,true)}function submitWithdraw(refCode,totalEarnings){let bank=document.getElementById('bank-name-field').value.trim();const name=document.getElementById('withdraw-name').value.trim();const phone=document.getElementById('withdraw-phone').value.trim();if(bank==='Lainnya'){const customBank=document.getElementById('other-bank-name').value.trim();if(!customBank){showModal("Input Kurang","Nama bank custom harus diisi.");return}bank=customBank}if(!name||!phone||!bank){showModal("Input Kurang","Semua kolom wajib diisi dan metode pencairan harus dipilih.");return}const emails=currentData.filter(item=>item.referral_code===refCode).map(item=>`- ${item.email} (${item.status})`).join('\n');const message=`*PENGAJUAN WITHDRAW ZEN*\n\n*Kode Referal:* ${refCode}\n*Dana Ditarik:* $${totalEarnings.toFixed(2)}\n\n*DATA PENCERAIAN:*\n*Atas Nama:* ${name}\n*No. Akun/HP:* ${phone}\n*Metode:* ${bank}\n\n*DAFTAR AGEN PENGUNDANG (Total ${emails.split('\n').length} Agen):*\n${emails}\n\nMohon diproses. Terima kasih.`;const waUrl=`https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(message)}`;closeModal();window.open(waUrl,'_blank')}window.onload=()=>{fetchData()}</script></body></html>
